function checkAnonymous() { $("#OnceAnonymous").is(":checked") ? ($("#onceContact").css("display", "none"), $("#OnceUser").prop("checked", !1)) : $("#onceContact").css("display", "") } function checkSubAnonymous() { $("#SubAnonymous").is(":checked") ? ($("#SubContact").css("display", "none"), $("#SubUser").prop("checked", !1)) : $("#SubContact").css("display", "") } function checkUser() { $("#OnceUser").is(":checked") ? ($("#onceContact").css("display", "none"), $("#OnceAnonymous").prop("checked", !1)) : $("#onceContact").css("display", "") } function checkSubUser() { $("#SubUser").is(":checked") ? ($("#SubContact").css("display", "none"), $("#SubAnonymous").prop("checked", !1)) : $("#SubContact").css("display", "") } function subAmount(e) { subId = e } function PrevTab() { $(".tabOnce > .active").prev("li").find("a").trigger("click") } function PrevTabSub() { $(".tabSub > .active").prev("li").find("a").trigger("click") } function OnceDonate() { var e = ""; Stripe.card.validateCardNumber($("#OnceCardNmber").val()) || (e += "Ugyldig kortnummer \n"), Stripe.card.validateCVC($("#OnceCvc").val()) || (e += "Ugyldig CVC \n"); var n = $("#OnceExpiration").val().split("/"); if (Stripe.card.validateExpiry(parseInt(n[0]), parseInt("20" + n[1])) || (e += "Ugyldig utløpsdato"), "" === stripePublic && (e += "Stripe er ikke konfigurert for nettsiden"), "" === e) { $("#OncePaymentError").text(""), cardnumber = $("#OnceCardNmber").val(), cvc = $("#OnceCvc").val(), expiration = $("#OnceExpiration").val(); var r = { number: cardnumber, exp_month: parseInt(n[0]), exp_year: parseInt("20" + n[1]), cvc: cvc }; "" !== name && (r.name = name), "" !== streetadress && (r.address_line1 = streetadress), "" !== city && (r.address_city = city), "" !== postcode && (r.address_zip = postcode), $(".loader").show(), Stripe.card.createToken(r, function (e, n) { if (n.error) return $("#OncePaymentError").text(n.error.message), void $(".loader").hide(); $("#OncePaymentError").text(""), token = n.id, processPayment() }) } else $("#OncePaymentError").text(e) } function SubDonate() { var e = ""; Stripe.card.validateCardNumber($("#SubCardNmber").val()) || (e += "Ugyldig kortnummer \n"), Stripe.card.validateCVC($("#SubCvc").val()) || (e += "Ugyldig CVC \n"); var n = $("#SubExpiration").val().split("/"); if (Stripe.card.validateExpiry(parseInt(n[0]), parseInt("20" + n[1])) || (e += "Ugyldig utløpsdato"), "" === stripePublic && (e += "Stripe er ikke konfigurert for nettsiden"), "" === e) { $("#SubPaymentError").text(""), subCardnumber = $("#SubCardNmber").val(), subCvc = $("#SubCvc").val(), subExpiration = $("#SubExpiration").val(); var r = { number: subCardnumber, exp_month: parseInt(n[0]), exp_year: parseInt("20" + n[1]), cvc: subCvc }; "" !== subName && (r.name = subName), "" !== subStreetadress && (r.address_line1 = subStreetadress), "" !== subCity && (r.address_city = subCity), "" !== subPostcode && (r.address_zip = subPostcode), $(".loader").show(), Stripe.card.createToken(r, function (e, n) { if (n.error) return $("#SubPaymentError").text(n.error.message), void $(".loader").hide(); $("#SubPaymentError").text(""), token = n.id, processSubPayment() }) } else $("#SubPaymentError").text(e) } function processPayment() { var e = new FormData; e.append("token", token), e.append("type", "once"), e.append("amount", amount), e.append("anon", anon), e.append("description", description), e.append("user", user), anon || (e.append("email", email), e.append("phone", phone), e.append("city", city), e.append("streetadress", streetadress), e.append("postcode", postcode), e.append("birthnumber", birthnumber), e.append("name", name)), $.ajax({ url: "/Home/HandlePayment", type: "POST", contentType: !1, processData: !1, data: e, success: function (e) { "false" == e.Success && "true" == e.striperesponse ? $("#OncePaymentError").text(JSON.parse(e.Error).error.message) : "false" == e.Success && "false" == e.striperesponse ? $("#OncePaymentError").text(e.Error) : $("#Donations").html(e) }, error: function (e) { console.log("error " + e.Error) } }) } function processSubPayment() { var e = new FormData; e.append("token", token), e.append("subId", subId), e.append("anon", subAnon), e.append("description", subDescription), e.append("user", subUser), anon || (e.append("email", subEmail), e.append("phone", subPhone), e.append("birthnumber", subBirthnumber), e.append("name", subName)), $.ajax({ url: "/Home/HandleSubPayment", type: "POST", contentType: !1, processData: !1, data: e, success: function (e) { "false" == e.Success && "true" == e.striperesponse ? $("#SubPaymentError").text(JSON.parse(e.Error).error.message) : "false" == e.Success && "false" == e.striperesponse ? $("#SubPaymentError").text(e.Error) : $("#Donations").html(e) }, error: function (e) { console.log("error " + e.Error) } }) } var anon = !1, user = !1, amount = 0, name = "", streetadress = "", phone = "", city = "", postcode = "", birthnumber = "", email = "", cardnumber = 0, expiration = "", cvc = 0, token = "", description = "", subAnon = !1, subUser = !1, subId = 0, subName = "", subStreetadress = "", subPhone = "", subCity = "", subPostcode = "", subBirthnumber = "", subEmail = "", subCardnumber = 0, subExpiration = "", subCvc = 0, subToken = "", subDescription = ""; $(function () { $("#OnceBirthNumber").tooltip() }), $(function () { $("SubBirthNumber").tooltip() }), $("#OnceAmountNext").click(function () { parseInt($("#AmountOnce").val()) > 0 ? (amount = parseInt($("#AmountOnce").val()), $(".tabOnce > .active").next("li").find("a").trigger("click"), $("#OnceAmountError").text("")) : $("#OnceAmountError").text("Ugyldig donasjonsmengde") }), $("#OnceContactNext").click(function () { if ($("#OnceAnonymous").is(":checked")) anon = !0, user = !1, description = $("#OnceDescription").val(), $(".tabOnce > .active").next("li").find("a").trigger("click"), $("#OnceContactError").text(""); else if ($("#OnceUser").is(":checked")) anon = !1, user = !0, description = $("#OnceDescription").val(), $(".tabOnce > .active").next("li").find("a").trigger("click"), $("#OnceContactError").text(""); else if ("" !== $("#OnceEmail").val() || "" !== $("#OnceCity").val() || "" !== $("#OnceName").val() || "" !== $("#OncePhone").val() || "" !== $("#OnceStreet").val() || "" !== $("#OncePostCode").val() || "" !== $("#OnceBirthNumber").val()) { var e = "", n = /[^\s@@]+@@[^\s@@]+\.[^\s@@]+/; if ("" === $("#OnceEmail").val() || n.test($("#OnceEmail").val()) || (e += "Ugyldig email \n"), "" !== $("#OnceBirthNumber").val() && (isNaN($("#OnceBirthNumber").val()) || $("#OnceBirthNumber").val().length < 11) && (e += "Ugyldig fødselsnummer \n"), "" !== $("#OncePostCode").val() && (isNaN($("#OncePostCode").val()) || $("#OncePostCode").val().length < 4) && (e += "Ugyldig postnummber \n"), "" !== e) return void $("#OnceContactError").text(e); anon = !1, email = $("#OnceEmail").val(), city = $("#OnceCity").val(), name = $("#OnceName").val(), phone = $("#OncePhone").val(), streetadress = $("#OnceStreet").val(), postcode = $("#OncePostCode").val(), birthnumber = $("#OnceBirthNumber").val(), $(".tabOnce > .active").next("li").find("a").trigger("click"), $("#OnceContactError").text("") } else $("#OnceContactError").text("Du må skrive inn kontaktinformasjon, velge å være anonym eller bruke nettsidebrukeren") }), $("#SubContactNext").click(function () { if ($("#SubAnonymous").is(":checked")) subAnon = !0, subUser = !1, subDescription = $("#SubDescription").val(), $(".tabSub > .active").next("li").find("a").trigger("click"), $("#SubContactError").text(""); else if ($("#SubUser").is(":checked")) subAnon = !1, subUser = !0, description = $("#SubDescription").val(), $(".tabSub > .active").next("li").find("a").trigger("click"), $("#SubContactError").text(""); else if ("" !== $("#SubEmail").val() || "" !== $("#SubCity").val() || "" !== $("#SubName").val() || "" !== $("#SubPhone").val() || "" !== $("#SubStreet").val() || "" !== $("#SubPostCode").val() || "" !== $("#SubBirthNumber").val()) { var e = "", n = /[^\s@@]+@@[^\s@@]+\.[^\s@@]+/; if ("" === $("#SubEmail").val() || n.test($("#SubEmail").val()) || (e += "Ugyldig email \n"), "" !== $("#SubBirthNumber").val() && (isNaN($("#SubBirthNumber").val()) || $("#SubBirthNumber").val().length < 11) && (e += "Ugyldig fødselsnummer \n"), "" !== $("#SubPostCode").val() && (isNaN($("#SubPostCode").val()) || $("#SubPostCode").val().length < 4) && (e += "Ugyldig postnummber \n"), "" !== e) return void $("#SubContactError").text(e); subAnon = !1, subEmail = $("#SubEmail").val(), subCity = $("#SubCity").val(), subName = $("#SubName").val(), subPhone = $("#SubPhone").val(), subStreetadress = $("#SubStreet").val(), subPostcode = $("#SubPostCode").val(), subBirthnumber = $("#SubBirthNumber").val(), $(".tabSub > .active").next("li").find("a").trigger("click"), $("#SubContactError").text("") } else $("#SubContactError").text("Du må skrive inn kontaktinformasjon, velge å være anonym eller bruke nettsidebrukeren") }), $("#SubAmountNext").click(function () { 0 !== subId ? $(".tabSub > .active").next("li").find("a").trigger("click") : $("#SubAmountError").text("Du må velge en plan") });